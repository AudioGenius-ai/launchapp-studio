# Project Management Plugin Plan

## Overview

A comprehensive Jira & Confluence-style project management plugin that provides task management and document collaboration features. The plugin will leverage the existing storage plugin for persistent data storage.

## Directory Structure

```
tauri-plugin-project-management/
├── Cargo.toml                    # Rust dependencies
├── build.rs                      # Permission generation
├── README.md                     # Plugin documentation
├── package.json                  # TypeScript dependencies
├── tsconfig.json                 # TypeScript configuration
├── src/                          # Rust source code
│   ├── lib.rs                   # Plugin initialization
│   ├── commands.rs              # Tauri commands
│   ├── models.rs                # Data structures
│   ├── error.rs                 # Error handling
│   ├── task_service.rs          # Task management logic
│   ├── document_service.rs      # Document management logic
│   ├── project_service.rs       # Project-level operations
│   ├── storage_manager.rs       # Storage integration
│   └── utils.rs                 # Helper functions
├── guest-js/                    # TypeScript bindings
│   ├── package.json
│   ├── tsconfig.json
│   └── src/
│       └── index.ts             # Frontend API
├── permissions/                 # Security permissions
│   ├── default.toml
│   └── autogenerated/           # Generated permissions
└── dist-js/                     # Built TypeScript output
```

## Storage Schema

### Project Structure

Each project gets its own directory: `~/.launchapp/<project-id>/`

### Task Storage (`~/.launchapp/<project-id>/tasks/<task-id>.json`)

```json
{
  "id": "task-uuid",
  "title": "Task title",
  "description": "Detailed description",
  "status": "todo" | "in_progress" | "done" | "blocked",
  "priority": "low" | "medium" | "high" | "urgent",
  "type": "story" | "bug" | "task" | "epic" | "subtask",
  "assignee": "user-id",
  "reporter": "user-id",
  "labels": ["tag1", "tag2"],
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z",
  "due_date": "2024-01-01T00:00:00Z",
  "estimate": 8, // hours
  "time_spent": 4, // hours
  "parent_id": "epic-uuid", // for subtasks
  "sprint_id": "sprint-uuid",
  "project_id": "project-uuid",
  "comments": [
    {
      "id": "comment-uuid",
      "author": "user-id",
      "content": "Comment text",
      "created_at": "2024-01-01T00:00:00Z"
    }
  ],
  "attachments": [
    {
      "id": "attachment-uuid",
      "filename": "screenshot.png",
      "path": "attachments/screenshot.png",
      "size": 1024,
      "created_at": "2024-01-01T00:00:00Z"
    }
  ],
  "checklist": [
    {
      "id": "checklist-uuid",
      "text": "Subtask description",
      "completed": false
    }
  ]
}
```

### Document Storage (`~/.launchapp/<project-id>/documents/<document-id>.mdx`)

```mdx
---
id: document-uuid
title: Document Title
author: user-id
created_at: 2024-01-01T00:00:00Z
updated_at: 2024-01-01T00:00:00Z
tags: [documentation, api, guide]
version: 1.0.0
status: draft | review | published | archived
parent_id: parent-document-uuid
template: page | blog | requirements | api-doc
permissions:
  read: [user1, team1]
  write: [user1]
  admin: [user1]
---

# Document Content

This is the MDX content with support for:
- Markdown formatting
- JSX components
- Code blocks with syntax highlighting
- Embedded diagrams
- Task references: [[TASK-123]]
- Document links: [[DOC-456]]

## Components Support

<TaskList projectId="project-uuid" status="in_progress" />

<Diagram type="flowchart">
graph TD
  A[Start] --> B[Process]
  B --> C[End]
</Diagram>

<CodeBlock language="typescript">
const example = "syntax highlighted code";
</CodeBlock>
```

### Project Metadata (`~/.launchapp/<project-id>/project.json`)

```json
{
  "id": "project-uuid",
  "name": "Project Name",
  "key": "PROJ", // Short key for task prefixes
  "description": "Project description",
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z",
  "owner": "user-id",
  "members": [
    {
      "user_id": "user-id",
      "role": "admin" | "member" | "viewer",
      "joined_at": "2024-01-01T00:00:00Z"
    }
  ],
  "settings": {
    "task_types": ["story", "bug", "task", "epic"],
    "statuses": ["todo", "in_progress", "done", "blocked"],
    "priorities": ["low", "medium", "high", "urgent"],
    "workflow": {
      "todo": ["in_progress"],
      "in_progress": ["done", "blocked"],
      "blocked": ["todo", "in_progress"],
      "done": []
    }
  },
  "sprints": [
    {
      "id": "sprint-uuid",
      "name": "Sprint 1",
      "start_date": "2024-01-01T00:00:00Z",
      "end_date": "2024-01-14T00:00:00Z",
      "status": "active" | "completed" | "planned",
      "goal": "Sprint goal description"
    }
  ]
}
```

## Core Features

### Task Management (Jira-like)

1. **CRUD Operations**
   - Create, read, update, delete tasks
   - Bulk operations for multiple tasks
   - Task filtering, sorting, and search

2. **Task Types & Workflows**
   - Configurable task types (Story, Bug, Task, Epic)
   - Custom status workflows
   - Priority management
   - Task relationships (parent/child, blocking)

3. **Sprint Management**
   - Create and manage sprints
   - Sprint planning and backlog management
   - Burndown charts and sprint reports

4. **Advanced Features**
   - Time tracking and estimates
   - File attachments
   - Task comments and activity log
   - Task templates
   - Custom fields

### Document Management (Confluence-like)

1. **Document Operations**
   - Create, edit, delete documents
   - Version history and diff view
   - Document templates
   - Rich MDX editing with preview

2. **Organization**
   - Hierarchical document structure
   - Document spaces and categories
   - Tagging and search
   - Favorites and recent documents

3. **Collaboration**
   - Document sharing and permissions
   - Comments and inline discussions
   - Real-time collaborative editing (future)
   - Document approval workflows

4. **Advanced Features**
   - Document linking and references
   - Embedded components (task lists, diagrams)
   - Export to PDF/HTML
   - Document analytics

## Rust Backend Implementation

### Core Services

#### TaskService

- Task CRUD operations
- Task querying and filtering
- Sprint management
- Time tracking
- Comment management

#### DocumentService

- Document CRUD operations
- MDX processing and validation
- Version management
- Template system
- Search indexing

#### ProjectService

- Project setup and configuration
- Member management
- Permission handling
- Settings management

#### StorageManager

- Integration with storage plugin
- File system operations
- Backup and restore
- Data migration

### Tauri Commands

#### Task Commands

- `create_task(project_id, task_data) -> Task`
- `get_task(project_id, task_id) -> Task`
- `update_task(project_id, task_id, task_data) -> Task`
- `delete_task(project_id, task_id) -> bool`
- `list_tasks(project_id, filters) -> Vec<Task>`
- `search_tasks(project_id, query) -> Vec<Task>`
- `move_task_to_sprint(project_id, task_id, sprint_id) -> bool`
- `add_task_comment(project_id, task_id, comment) -> Comment`
- `upload_task_attachment(project_id, task_id, file_data) -> Attachment`

#### Document Commands

- `create_document(project_id, document_data) -> Document`
- `get_document(project_id, document_id) -> Document`
- `update_document(project_id, document_id, content) -> Document`
- `delete_document(project_id, document_id) -> bool`
- `list_documents(project_id, filters) -> Vec<Document>`
- `search_documents(project_id, query) -> Vec<Document>`
- `get_document_history(project_id, document_id) -> Vec<DocumentVersion>`
- `render_document(project_id, document_id) -> String` // HTML output

#### Project Commands

- `create_project(project_data) -> Project`
- `get_project(project_id) -> Project`
- `update_project(project_id, project_data) -> Project`
- `delete_project(project_id) -> bool`
- `list_projects() -> Vec<Project>`
- `add_project_member(project_id, user_id, role) -> bool`
- `remove_project_member(project_id, user_id) -> bool`

#### Sprint Commands

- `create_sprint(project_id, sprint_data) -> Sprint`
- `update_sprint(project_id, sprint_id, sprint_data) -> Sprint`
- `start_sprint(project_id, sprint_id) -> bool`
- `complete_sprint(project_id, sprint_id) -> bool`
- `get_sprint_report(project_id, sprint_id) -> SprintReport`

## TypeScript Frontend Integration

### API Bindings

```typescript
export interface Task {
  id: string;
  title: string;
  description: string;
  status: TaskStatus;
  priority: TaskPriority;
  type: TaskType;
  assignee?: string;
  reporter: string;
  labels: string[];
  createdAt: Date;
  updatedAt: Date;
  dueDate?: Date;
  estimate?: number;
  timeSpent?: number;
  parentId?: string;
  sprintId?: string;
  projectId: string;
  comments: Comment[];
  attachments: Attachment[];
  checklist: ChecklistItem[];
}

export interface Document {
  id: string;
  title: string;
  content: string; // MDX content
  author: string;
  createdAt: Date;
  updatedAt: Date;
  tags: string[];
  version: string;
  status: DocumentStatus;
  parentId?: string;
  template: DocumentTemplate;
  permissions: DocumentPermissions;
}

// Command wrappers
export async function createTask(projectId: string, taskData: Partial<Task>): Promise<Task> {
  return invoke('plugin:project-management|create_task', { projectId, taskData });
}

export async function createDocument(projectId: string, documentData: Partial<Document>): Promise<Document> {
  return invoke('plugin:project-management|create_document', { projectId, documentData });
}
```

## UI Components (Future Integration)

### Task Management UI

- **Kanban Board**: Drag-and-drop task management
- **Task List**: Filterable and sortable task grid
- **Task Detail**: Comprehensive task editing form
- **Sprint Board**: Sprint planning and management
- **Reports**: Burndown charts, velocity reports

### Document UI

- **Document Editor**: Rich MDX editor with preview
- **Document Tree**: Hierarchical document navigation
- **Document Viewer**: Rendered document display
- **Template Gallery**: Document template selection
- **Version History**: Document diff and restore

### Project UI

- **Project Dashboard**: Overview with metrics
- **Project Settings**: Configuration and member management
- **Activity Feed**: Recent project activity
- **Search Interface**: Global search across tasks and documents

## Security & Permissions

### File System Access

- Restricted to `~/.launchapp/` directory
- Project-scoped access control
- Secure file upload handling

### Permission Model

- Project-level permissions (admin, member, viewer)
- Document-level permissions (read, write, admin)
- Task assignment restrictions

### Data Validation

- Input sanitization for all commands
- File type validation for attachments
- MDX content validation and security

## Performance Considerations

### Caching Strategy

- In-memory caching for frequently accessed data
- Lazy loading for large document content
- Pagination for large task lists

### File Management

- Efficient file watching for real-time updates
- Incremental document parsing
- Attachment size limits and compression

### Search Optimization

- Full-text search indexing
- Search result caching
- Query optimization

## Integration Points

### Storage Plugin

- Leverage existing storage plugin for data persistence
- Encrypted storage for sensitive data
- Backup and restore capabilities

### Git Integration

- Link tasks to Git commits and branches
- Document version control integration
- Code reference linking

### Terminal Integration

- Task creation from terminal commands
- Git commit message templates with task references

## Testing Strategy

### Unit Tests

- Rust service layer testing
- Command validation testing
- Data model testing

### Integration Tests

- End-to-end workflow testing
- File system operation testing
- Cross-plugin integration testing

## Future Enhancements

### Phase 2 Features

- Real-time collaboration
- Advanced reporting and analytics
- Email notifications
- Calendar integration
- External tool integrations (GitHub, Slack)

### Plugin Ecosystem

- Custom field plugins
- Workflow automation plugins
- Third-party integrations
- Custom document components

## Migration Strategy

### From Existing Tools

- Import from Jira (JSON export)
- Import from Confluence (XML/HTML export)
- Import from Markdown documentation
- Bulk task creation from CSV

### Backup & Recovery

- Automated backup scheduling
- Project export functionality
- Disaster recovery procedures

## Deployment Considerations

### Bundle Size

- Lazy loading for large components
- Code splitting for feature modules
- Asset optimization

### Performance Monitoring

- Command execution time tracking
- File system operation monitoring
- Memory usage optimization

This comprehensive plan provides the foundation for implementing a powerful project management plugin that rivals commercial tools while maintaining the flexibility and customization of our open-source ecosystem.
